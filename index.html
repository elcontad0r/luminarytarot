<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientists & Sci-Fi Tarot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0e27 0%, #1a0b2e 50%, #16213e 100%);
            min-height: 100vh;
            font-family: 'Georgia', serif;
            color: #e8d5b7;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            overflow-x: hidden;
        }

        h1 {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 0.5rem;
            letter-spacing: 0.3rem;
            text-transform: uppercase;
            background: linear-gradient(90deg, #b8860b, #ffd700, #b8860b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .subtitle {
            text-align: center;
            margin-bottom: 1rem;
            opacity: 0.7;
            font-style: italic;
        }

        .deck-info {
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: #b8860b;
            opacity: 0.8;
        }

        .spread-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .spread-option {
            padding: 0.5rem 1.5rem;
            background: rgba(74, 63, 107, 0.3);
            border: 1px solid #4a3f6b;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .spread-option.active {
            background: rgba(74, 63, 107, 0.6);
            border-color: #ffd700;
            color: #ffd700;
        }

        .spread-option:hover {
            background: rgba(74, 63, 107, 0.5);
        }

        .spread-container {
            display: flex;
            gap: 2rem;
            justify-content: center;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            min-height: 320px;
        }

        .card-position {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 160px;
        }

        .position-label {
            color: #b8860b;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            opacity: 0.8;
            min-height: 20px;
            text-align: center;
        }

        .card {
            width: 160px;
            height: 260px;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            border: 2px solid #4a3f6b;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        }

        .card-back {
            background: radial-gradient(ellipse at center, #2a1a4e, #0a0e27);
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            transform: rotateY(0deg);
            z-index: 2;
        }

        .card-back::before {
            content: "";
            position: absolute;
            width: 150%;
            height: 150%;
            background: repeating-conic-gradient(
                from 0deg at 50% 50%,
                transparent 0deg,
                #4a3f6b 20deg,
                transparent 40deg
            );
            animation: rotate 20s linear infinite;
            opacity: 0.3;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .card-back-text {
            font-size: 2.5rem;
            z-index: 1;
            opacity: 0.6;
        }

        .card-front {
            background: linear-gradient(145deg, #1e3c72, #2a5298);
            transform: rotateY(180deg);
            padding: 0.8rem 0.5rem;
            text-align: center;
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .card-front.minor-wands {
            background: linear-gradient(145deg, #8B2C02, #D2691E);
        }

        .card-front.minor-cups {
            background: linear-gradient(145deg, #1e3c72, #4682B4);
        }

        .card-front.minor-swords {
            background: linear-gradient(145deg, #4a5568, #718096);
        }

        .card-front.minor-pentacles {
            background: linear-gradient(145deg, #2d4a2b, #4a7c4e);
        }

        .suit-indicator {
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            font-size: 0.7rem;
            font-weight: bold;
            opacity: 0.9;
            color: #ffd700;
            text-transform: uppercase;
            letter-spacing: 0.02rem;
        }

        .arcana-number {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1rem;
            color: #ffd700;
            font-weight: bold;
            font-family: Georgia, serif;
        }

        .figure-symbol {
            width: 50px;
            height: 50px;
            margin: 0.5rem auto;
            border: 2px solid #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            font-family: Georgia, serif;
            font-weight: bold;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.2), transparent);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
            color: #ffd700;
        }

        .figure-name {
            font-size: 0.85rem;
            margin-bottom: 0.2rem;
            color: #ffd700;
            text-transform: uppercase;
            letter-spacing: 0.02rem;
            line-height: 1.2;
            max-width: 90%;
            word-wrap: break-word;
        }

        .arcana-name {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 0.3rem;
            font-weight: bold;
        }

        .figure-title {
            font-size: 0.75rem;
            opacity: 0.7;
            font-style: italic;
            max-width: 90%;
        }

        .reversed-indicator {
            position: absolute;
            bottom: 5px;
            right: 5px;
            color: #ff6b6b;
            font-size: 1rem;
            opacity: 0.8;
            font-weight: normal;
        }

        .draw-button {
            padding: 1rem 3rem;
            font-size: 1.1rem;
            background: linear-gradient(145deg, #4a3f6b, #2a1a4e);
            border: 2px solid #b8860b;
            color: #e8d5b7;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 2rem;
        }

        .draw-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            background: linear-gradient(145deg, #5a4f7b, #3a2a5e);
        }

        .draw-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .interpretation {
            max-width: 900px;
            margin-top: 2rem;
            padding: 2rem;
            background: rgba(10, 14, 39, 0.95);
            border-radius: 15px;
            border: 1px solid #4a3f6b;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }

        .interpretation.show {
            opacity: 1;
            transform: translateY(0);
        }

        .interpretation h3 {
            color: #ffd700;
            margin-bottom: 1.5rem;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
            font-size: 1.3rem;
        }

        .card-meanings {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .card-meaning {
            padding: 1rem;
            background: rgba(42, 26, 78, 0.3);
            border-radius: 10px;
            border-left: 3px solid #b8860b;
        }

        .card-meaning h4 {
            color: #ffd700;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .reversed-badge {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
        }

        .card-meaning p {
            line-height: 1.6;
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .synthesis {
            padding-top: 1.5rem;
            border-top: 1px solid #4a3f6b;
        }

        .synthesis h4 {
            color: #ffd700;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
        }

        .synthesis p {
            line-height: 1.8;
            opacity: 0.9;
            margin-bottom: 1rem;
            text-align: justify;
        }

        .mystical-guidance {
            margin-top: 1.5rem;
            padding: 1rem;
            border-top: 1px solid rgba(255, 215, 0, 0.3);
            font-style: italic;
            opacity: 0.9;
        }

        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 4s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        @media (max-width: 768px) {
            .card {
                width: 120px;
                height: 200px;
            }
            
            .card-position {
                width: 120px;
            }
            
            .spread-container {
                gap: 1rem;
            }
            
            .figure-name {
                font-size: 0.75rem;
            }
            
            .arcana-name {
                font-size: 0.7rem;
            }
            
            .figure-title {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <h1>Quantum Arcana</h1>
    <p class="subtitle">Scientists & Speculative Fiction</p>
    <p class="deck-info">78 Cards • Full Traditional Structure</p>
    
    <div class="spread-selector">
        <div class="spread-option active" data-spread="time">Past • Present • Future</div>
        <div class="spread-option" data-spread="action">Situation • Action • Outcome</div>
        <div class="spread-option" data-spread="being">Mind • Body • Spirit</div>
    </div>
    
    <div class="spread-container" id="spreadContainer"></div>
    
    <button class="draw-button" id="drawButton">Draw Three Cards</button>
    
    <div class="interpretation" id="interpretation">
        <h3 id="readingTitle">Your Reading</h3>
        <div class="card-meanings" id="cardMeanings"></div>
        <div class="synthesis">
            <h4>Synthesis</h4>
            <p id="synthesisText"></p>
            <div class="mystical-guidance" id="guidance"></div>
        </div>
    </div>

    <script>
        // Complete revised deck
        const majorArcana = [
            {
                number: 0,
                arcana: "The Fool",
                figure: "Alan Turing",
                title: "Innocent Algorithm",
                symbol: "0",
                element: "Air",
                meaning: {
                    upright: "New beginnings, innocence, unconventional thinking",
                    reversed: "Naivety, recklessness, persecution for being different"
                }
            },
            {
                number: 1,
                arcana: "The Magician",
                figure: "Ted Chiang",
                title: "Reality Architect",
                symbol: "I",
                element: "Mercury",
                meaning: {
                    upright: "Manifestation, making the impossible logical, transformation",
                    reversed: "Manipulation, untapped potential, illusion"
                }
            },
            {
                number: 2,
                arcana: "The High Priestess",
                figure: "Ursula K. Le Guin",
                title: "Keeper of Other Worlds",
                symbol: "II",
                element: "Moon",
                meaning: {
                    upright: "Hidden wisdom, intuition, the power of the unnamed",
                    reversed: "Secrets, disconnection, things unsaid"
                }
            },
            {
                number: 3,
                arcana: "The Empress",
                figure: "Lynn Margulis",
                title: "Symbiotic Mother",
                symbol: "III",
                element: "Venus",
                meaning: {
                    upright: "Creative abundance, symbiosis, nurturing systems",
                    reversed: "Creative block, parasitism, smothering"
                }
            },
            {
                number: 4,
                arcana: "The Emperor",
                figure: "John von Neumann",
                title: "Logical Sovereign",
                symbol: "IV",
                element: "Aries",
                meaning: {
                    upright: "Authority, structure, systematic thinking",
                    reversed: "Tyranny of logic, rigidity, control issues"
                }
            },
            {
                number: 5,
                arcana: "The Hierophant",
                figure: "Isaac Asimov",
                title: "Laws Keeper",
                symbol: "V",
                element: "Taurus",
                meaning: {
                    upright: "Teaching, tradition, established principles",
                    reversed: "Dogma, outdated rules, need for rebellion"
                }
            },
            {
                number: 6,
                arcana: "The Lovers",
                figure: "Marie Curie",
                title: "Radiant Partnership",
                symbol: "VI",
                element: "Gemini",
                meaning: {
                    upright: "Union, collaboration, aligned values",
                    reversed: "Disharmony, sacrifice, imbalanced partnership"
                }
            },
            {
                number: 7,
                arcana: "The Chariot",
                figure: "Katherine Johnson",
                title: "Trajectory Master",
                symbol: "VII",
                element: "Cancer",
                meaning: {
                    upright: "Determination, calculated victory, navigation",
                    reversed: "Lack of direction, obstacles, miscalculation"
                }
            },
            {
                number: 8,
                arcana: "Strength",
                figure: "Jane Goodall",
                title: "Patient Observer",
                symbol: "VIII",
                element: "Leo",
                meaning: {
                    upright: "Patience, gentle strength, long observation",
                    reversed: "Self-doubt, impatience, disconnection from nature"
                }
            },
            {
                number: 9,
                arcana: "The Hermit",
                figure: "Liu Cixin",
                title: "Dark Forest Philosopher",
                symbol: "IX",
                element: "Virgo",
                meaning: {
                    upright: "Solitude, deep contemplation, cosmic perspective",
                    reversed: "Isolation, paranoia, lost in theory"
                }
            },
            {
                number: 10,
                arcana: "Wheel of Fortune",
                figure: "Charles Darwin",
                title: "Evolution's Hand",
                symbol: "X",
                element: "Jupiter",
                meaning: {
                    upright: "Natural selection, cycles, adaptation",
                    reversed: "Inability to adapt, fighting evolution, bad timing"
                }
            },
            {
                number: 11,
                arcana: "Justice",
                figure: "Rosalind Franklin",
                title: "Unrecognized Truth",
                symbol: "XI",
                element: "Libra",
                meaning: {
                    upright: "Truth revealed, karmic justice, clarity",
                    reversed: "Injustice, stolen credit, hidden contributions"
                }
            },
            {
                number: 12,
                arcana: "The Hanged Man",
                figure: "Galileo Galilei",
                title: "Suspended Vision",
                symbol: "XII",
                element: "Neptune",
                meaning: {
                    upright: "New perspective, necessary sacrifice, paradigm shift",
                    reversed: "Martyrdom, stubbornness, needless sacrifice"
                }
            },
            {
                number: 13,
                arcana: "Death",
                figure: "J. Robert Oppenheimer",
                title: "Destroyer of Worlds",
                symbol: "XIII",
                element: "Scorpio",
                meaning: {
                    upright: "Transformation, endings, nuclear change",
                    reversed: "Fear of change, stagnation, living with consequences"
                }
            },
            {
                number: 14,
                arcana: "Temperance",
                figure: "Barbara McClintock",
                title: "Genetic Alchemist",
                symbol: "XIV",
                element: "Sagittarius",
                meaning: {
                    upright: "Patient observation, synthesis, genetic harmony",
                    reversed: "Impatience, forcing results, imbalance"
                }
            },
            {
                number: 15,
                arcana: "The Devil",
                figure: "Werner von Braun",
                title: "Ambition's Price",
                symbol: "XV",
                element: "Capricorn",
                meaning: {
                    upright: "Ambition, moral compromise, binding contracts",
                    reversed: "Breaking free from past, confronting shadows"
                }
            },
            {
                number: 16,
                arcana: "The Tower",
                figure: "Werner Heisenberg",
                title: "Uncertainty Principle",
                symbol: "XVI",
                element: "Mars",
                meaning: {
                    upright: "Sudden revelation, paradigm collapse, uncertainty",
                    reversed: "Avoiding truth, delaying inevitable, resistance"
                }
            },
            {
                number: 17,
                arcana: "The Star",
                figure: "Octavia Butler",
                title: "Future Seer",
                symbol: "XVII",
                element: "Aquarius",
                meaning: {
                    upright: "Hope, inspiration, visionary thinking",
                    reversed: "Despair, disconnection from vision, lost faith"
                }
            },
            {
                number: 18,
                arcana: "The Moon",
                figure: "Philip K. Dick",
                title: "Reality Questioner",
                symbol: "XVIII",
                element: "Pisces",
                meaning: {
                    upright: "Illusion, intuition, questioning reality",
                    reversed: "Paranoia, confusion, lost in simulation"
                }
            },
            {
                number: 19,
                arcana: "The Sun",
                figure: "Buckminster Fuller",
                title: "Synergetic Mind",
                symbol: "XIX",
                element: "Sun",
                meaning: {
                    upright: "Innovation, optimism, whole systems thinking",
                    reversed: "Over-optimism, scattered energy, failed utopia"
                }
            },
            {
                number: 20,
                arcana: "Judgement",
                figure: "Rachel Carson",
                title: "Silent Spring",
                symbol: "XX",
                element: "Pluto",
                meaning: {
                    upright: "Awakening, environmental reckoning, call to action",
                    reversed: "Ignoring warnings, denial, missed calling"
                }
            },
            {
                number: 21,
                arcana: "The World",
                figure: "Ada Lovelace",
                title: "First Algorithm",
                symbol: "XXI",
                element: "Saturn",
                meaning: {
                    upright: "Completion, integration, realized vision",
                    reversed: "Incomplete work, unfulfilled potential, seeking closure"
                }
            }
        ];

        const minorArcana = {
            wands: {
                suit: "Wands",
                element: "Fire",
                domain: "Innovation & Engineering",
                symbol: "♦",
                cards: [
                    { rank: "Ace", figure: "Archimedes", title: "Eureka Moment", meaning: { upright: "Creative breakthrough, sudden insight", reversed: "False starts, blocked creativity" }},
                    { rank: "Two", figure: "Hedy Lamarr", title: "Frequency Hopper", meaning: { upright: "Planning innovation, dual nature", reversed: "Scattered plans, hidden talents" }},
                    { rank: "Three", figure: "Nikola Tesla", title: "Visionary Builder", meaning: { upright: "Long-term vision, expansion", reversed: "Delays, unrealized visions" }},
                    { rank: "Four", figure: "Grace Hopper", title: "Bug Finder", meaning: { upright: "Celebrating milestones, solid foundation", reversed: "Lack of recognition, unstable base" }},
                    { rank: "Five", figure: "Margaret Hamilton", title: "Software Pioneer", meaning: { upright: "Fighting for recognition, competition", reversed: "Avoiding conflict, internal struggle" }},
                    { rank: "Six", figure: "Claude Shannon", title: "Information Victor", meaning: { upright: "Public victory, recognition", reversed: "Private success, setback" }},
                    { rank: "Seven", figure: "Mary Jackson", title: "Barrier Breaker", meaning: { upright: "Defending position, perseverance", reversed: "Giving up, overwhelmed" }},
                    { rank: "Eight", figure: "Dorothy Vaughan", title: "Swift Adapter", meaning: { upright: "Rapid progress, quick thinking", reversed: "Haste, scattered energy" }},
                    { rank: "Nine", figure: "Frances Northcutt", title: "Mission Controller", meaning: { upright: "Resilience, last stand", reversed: "Exhaustion, paranoia" }},
                    { rank: "Ten", figure: "Donna Haraway", title: "Cyborg Burden", meaning: { upright: "Success but overwhelmed", reversed: "Laying down burdens" }},
                    { rank: "Page", figure: "Tim Berners-Lee", title: "Web Weaver", meaning: { upright: "New connections, exploration", reversed: "Bad news, disconnection" }},
                    { rank: "Knight", figure: "Richard Feynman", title: "Curious Adventurer", meaning: { upright: "Passionate pursuit, energy", reversed: "Recklessness, scattered focus" }},
                    { rank: "Queen", figure: "Zaha Hadid", title: "Form Shaper", meaning: { upright: "Creative confidence, bold vision", reversed: "Creative doubt, jealousy" }},
                    { rank: "King", figure: "Thomas Edison", title: "Patent King", meaning: { upright: "Entrepreneurial mastery, vision", reversed: "Ruthless ambition, burnout" }}
                ]
            },
            cups: {
                suit: "Cups",
                element: "Water",
                domain: "Life Sciences & Medicine",
                symbol: "♥",
                cards: [
                    { rank: "Ace", figure: "Florence Nightingale", title: "Lamp Bearer", meaning: { upright: "Compassion, new emotional beginning", reversed: "Emotional depletion, blocked empathy" }},
                    { rank: "Two", figure: "Jonas Salk", title: "Gift Giver", meaning: { upright: "Partnership, mutual benefit", reversed: "Imbalance, broken trust" }},
                    { rank: "Three", figure: "Alexander Fleming", title: "Accidental Discovery", meaning: { upright: "Celebration, collaboration, serendipity", reversed: "Overindulgence, scattered team" }},
                    { rank: "Four", figure: "Henrietta Lacks", title: "Immortal Cells", meaning: { upright: "Contemplation, reevaluation", reversed: "Missed opportunity, apathy" }},
                    { rank: "Five", figure: "Ignaz Semmelweis", title: "Rejected Savior", meaning: { upright: "Grief, rejection, loss", reversed: "Acceptance, moving forward" }},
                    { rank: "Six", figure: "Oliver Sacks", title: "Awakener", meaning: { upright: "Nostalgia, innocence, reunion", reversed: "Living in past, naive trust" }},
                    { rank: "Seven", figure: "Temple Grandin", title: "Different Mind", meaning: { upright: "Many options, imagination", reversed: "Illusion, overwhelmed by choice" }},
                    { rank: "Eight", figure: "Rita Levi-Montalcini", title: "Secret Lab", meaning: { upright: "Walking away, seeking more", reversed: "Fear of abandonment, stagnation" }},
                    { rank: "Nine", figure: "Frances Kelsey", title: "Guardian", meaning: { upright: "Contentment, emotional fulfillment", reversed: "Smug satisfaction, materialism" }},
                    { rank: "Ten", figure: "Mary Anning", title: "Fossil Mother", meaning: { upright: "Family harmony, legacy", reversed: "Broken family, dysfunction" }},
                    { rank: "Page", figure: "Jennifer Doudna", title: "CRISPR Creator", meaning: { upright: "New ideas, intuitive messages", reversed: "Creative blocks, bad news" }},
                    { rank: "Knight", figure: "Santiago Ramón y Cajal", title: "Neural Artist", meaning: { upright: "Romance with work, following passion", reversed: "Moodiness, artistic temperament" }},
                    { rank: "Queen", figure: "Dorothy Hodgkin", title: "Crystal Seer", meaning: { upright: "Emotional maturity, intuitive", reversed: "Emotional manipulation, dependency" }},
                    { rank: "King", figure: "Louis Pasteur", title: "Life Protector", meaning: { upright: "Emotional control, wisdom", reversed: "Coldness, repressed emotions" }}
                ]
            },
            swords: {
                suit: "Swords",
                element: "Air",
                domain: "Physics & Mathematics",
                symbol: "♠",
                cards: [
                    { rank: "Ace", figure: "Emmy Noether", title: "Symmetry Blade", meaning: { upright: "Mental clarity, breakthrough", reversed: "Confusion, mental fog" }},
                    { rank: "Two", figure: "Niels Bohr", title: "Complementarity", meaning: { upright: "Difficult decision, stalemate", reversed: "Indecision, information overload" }},
                    { rank: "Three", figure: "Erwin Schrödinger", title: "Cat's Fate", meaning: { upright: "Heartbreak, difficult truth", reversed: "Recovery, releasing pain" }},
                    { rank: "Four", figure: "Paul Dirac", title: "Silent Thinker", meaning: { upright: "Rest, contemplation, recovery", reversed: "Restlessness, burnout" }},
                    { rank: "Five", figure: "Wolfgang Pauli", title: "Exclusion Principle", meaning: { upright: "Conflict, defeat, exclusion", reversed: "Reconciliation, past opening" }},
                    { rank: "Six", figure: "Max Planck", title: "Quantum Leap", meaning: { upright: "Transition, leaving behind", reversed: "Baggage, unfinished business" }},
                    { rank: "Seven", figure: "Lise Meitner", title: "Hidden Fission", meaning: { upright: "Deception, strategy, theft", reversed: "Coming clean, confession" }},
                    { rank: "Eight", figure: "Chien-Shiung Wu", title: "Parity Breaker", meaning: { upright: "Restriction, imprisonment", reversed: "Freedom, new perspective" }},
                    { rank: "Nine", figure: "Abdus Salam", title: "Unified Fields", meaning: { upright: "Anxiety, nightmares, worry", reversed: "Hope, reaching out" }},
                    { rank: "Ten", figure: "Subrahmanyan Chandrasekhar", title: "Collapse Point", meaning: { upright: "Painful ending, betrayal", reversed: "Recovery, learning from pain" }},
                    { rank: "Page", figure: "Terence Tao", title: "Prodigy", meaning: { upright: "New ideas, mental energy", reversed: "Hasty decisions, cutting words" }},
                    { rank: "Knight", figure: "Edward Witten", title: "String Theorist", meaning: { upright: "Direct action, intellectual pursuit", reversed: "No tact, scattered thinking" }},
                    { rank: "Queen", figure: "Lisa Randall", title: "Dimension Explorer", meaning: { upright: "Clear perception, direct communication", reversed: "Cold logic, cruelty" }},
                    { rank: "King", figure: "Albert Einstein", title: "Relativity Master", meaning: { upright: "Intellectual authority, clear thinking", reversed: "Manipulation, overthinking" }}
                ]
            },
            pentacles: {
                suit: "Pentacles",
                element: "Earth",
                domain: "Natural Sciences & Astronomy",
                symbol: "♣",
                cards: [
                    { rank: "Ace", figure: "Maria Sibylla Merian", title: "Metamorphosis", meaning: { upright: "New material opportunity, manifestation", reversed: "Lost opportunity, poor planning" }},
                    { rank: "Two", figure: "Annie Jump Cannon", title: "Star Classifier", meaning: { upright: "Balance, juggling priorities", reversed: "Imbalance, dropping balls" }},
                    { rank: "Three", figure: "Cecilia Payne-Gaposchkin", title: "Star Stuff", meaning: { upright: "Collaboration, teamwork", reversed: "Lack of teamwork, working alone" }},
                    { rank: "Four", figure: "Vera Rubin", title: "Dark Matter", meaning: { upright: "Conservation, holding tight", reversed: "Greed, being too conservative" }},
                    { rank: "Five", figure: "Jocelyn Bell Burnell", title: "Pulse Finder", meaning: { upright: "Financial worry, insecurity", reversed: "Recovery from loss" }},
                    { rank: "Six", figure: "Mae Jemison", title: "Space Doctor", meaning: { upright: "Generosity, success, sharing", reversed: "Selfishness, unpaid debts" }},
                    { rank: "Seven", figure: "Sally Ride", title: "First Flight", meaning: { upright: "Long-term investment, patience", reversed: "Lack of reward, impatience" }},
                    { rank: "Eight", figure: "Mary Leakey", title: "Deep Digger", meaning: { upright: "Apprenticeship, skill building", reversed: "Perfectionism, lack of focus" }},
                    { rank: "Nine", figure: "Dian Fossey", title: "Gorilla Guardian", meaning: { upright: "Abundance, self-sufficiency", reversed: "Isolation, hoarding" }},
                    { rank: "Ten", figure: "Wangari Maathai", title: "Tree Mother", meaning: { upright: "Legacy, family wealth, inheritance", reversed: "Financial loss, no legacy" }},
                    { rank: "Page", figure: "Carl Sagan", title: "Cosmic Student", meaning: { upright: "Study, new skill, messages", reversed: "Lack of progress, bad news" }},
                    { rank: "Knight", figure: "Srinivasa Ramanujan", title: "Pattern Seeker", meaning: { upright: "Routine, methodical progress", reversed: "Boredom, feeling stuck" }},
                    { rank: "Queen", figure: "Sylvia Earle", title: "Ocean Mother", meaning: { upright: "Nurturing, practical, down-to-earth", reversed: "Self-neglect, smothering" }},
                    { rank: "King", figure: "E.O. Wilson", title: "Biodiversity King", meaning: { upright: "Success, leadership, security", reversed: "Greed, materialistic, stubborn" }}
                ]
            }
        };

        const spreads = {
            time: {
                name: "Past • Present • Future",
                positions: ["Past", "Present", "Future"],
                descriptions: [
                    "What foundation was laid",
                    "Where you stand now",
                    "What's emerging ahead"
                ]
            },
            action: {
                name: "Situation • Action • Outcome",
                positions: ["Situation", "Action", "Outcome"],
                descriptions: [
                    "The true nature of things",
                    "Your best approach",
                    "The likely result"
                ]
            },
            being: {
                name: "Mind • Body • Spirit",
                positions: ["Mind", "Body", "Spirit"],
                descriptions: [
                    "Your mental state",
                    "Material reality",
                    "Higher purpose"
                ]
            }
        };

        let currentSpread = 'time';
        let drawnCards = [];
        let isDrawing = false;

        // Combine all cards into full deck
        function getFullDeck() {
            const deck = [...majorArcana];
            
            Object.values(minorArcana).forEach(suit => {
                suit.cards.forEach(card => {
                    deck.push({
                        ...card,
                        suit: suit.suit,
                        symbol: suit.symbol,
                        suitElement: suit.element,
                        type: 'minor'
                    });
                });
            });
            
            return deck;
        }

        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                starsContainer.appendChild(star);
            }
        }

        function initializeSpread() {
            const container = document.getElementById('spreadContainer');
            const spread = spreads[currentSpread];
            
            container.innerHTML = spread.positions.map((pos, i) => `
                <div class="card-position">
                    <div class="position-label">${pos}</div>
                    <div class="card" id="card${i + 1}" data-position="${i}">
                        <div class="card-face card-back">
                            <div class="card-back-text">☆</div>
                        </div>
                        <div class="card-face card-front" id="cardFront${i + 1}">
                            <div class="arcana-number"></div>
                            <div class="suit-indicator"></div>
                            <div class="figure-symbol"></div>
                            <div class="figure-name"></div>
                            <div class="arcana-name"></div>
                            <div class="figure-title"></div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function drawCards() {
            if (isDrawing) return;
            isDrawing = true;

            document.getElementById('interpretation').classList.remove('show');
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('is-flipped');
            });
            document.querySelectorAll('.reversed-indicator').forEach(indicator => {
                indicator.remove();
            });

            const deck = getFullDeck();
            drawnCards = [];
            
            for (let i = 0; i < 3; i++) {
                const randomIndex = Math.floor(Math.random() * deck.length);
                const card = {...deck[randomIndex]};
                card.isReversed = Math.random() < 0.35; // 35% chance reversed
                drawnCards.push(card);
                deck.splice(randomIndex, 1);
            }

            // Staggered flip animation
            let delay = 300;
            drawnCards.forEach((card, index) => {
                setTimeout(() => {
                    flipCard(index + 1, card);
                    if (index === 2) {
                        setTimeout(() => {
                            showInterpretation();
                            isDrawing = false;
                        }, 600);
                    }
                }, delay);
                delay += 300;
            });
        }

        function flipCard(cardNum, cardData) {
            const card = document.getElementById(`card${cardNum}`);
            const front = document.getElementById(`cardFront${cardNum}`);
            
            // Apply suit-specific styling for minor arcana
            if (cardData.type === 'minor') {
                front.className = `card-face card-front minor-${cardData.suit.toLowerCase()}`;
                front.querySelector('.suit-indicator').textContent = `${cardData.rank} of ${cardData.suit}`;
                front.querySelector('.arcana-number').textContent = '';
                front.querySelector('.figure-symbol').textContent = cardData.symbol || '';
            } else {
                front.querySelector('.arcana-number').textContent = 
                    cardData.number === 0 ? '0' : cardData.number < 10 ? `0${cardData.number}` : cardData.number;
                front.querySelector('.suit-indicator').textContent = '';
                front.querySelector('.figure-symbol').textContent = cardData.symbol || '';
            }
            
            front.querySelector('.figure-name').textContent = cardData.figure;
            front.querySelector('.arcana-name').textContent = cardData.arcana || '';
            front.querySelector('.figure-title').textContent = cardData.title;
            
            if (cardData.isReversed) {
                const reversedSpan = document.createElement('span');
                reversedSpan.className = 'reversed-indicator';
                reversedSpan.textContent = '⟲';
                front.appendChild(reversedSpan);
            }
            
            card.classList.add('is-flipped');
        }

        function generateReading() {
            const spread = spreads[currentSpread];
            const [first, second, third] = drawnCards;
            
            const patterns = analyzePatterns(drawnCards);
            let reading = "";
            
            if (patterns.majorCount === 3) {
                reading = "Three Major Arcana — this reading operates at the archetypal level, addressing core life patterns rather than surface events.\n\n";
            } else if (patterns.reversedCount === 3) {
                reading = "All reversed — the work here is entirely internal. External action should wait until inner clarity emerges.\n\n";
            } else if (patterns.dominantElement) {
                const elemental = {
                    'Fire': "Fire dominates — action and creation take precedence.",
                    'Water': "Water dominates — emotional intelligence guides the way.",
                    'Air': "Air dominates — mental clarity and communication are key.",
                    'Earth': "Earth dominates — practical matters require attention."
                };
                reading = (elemental[patterns.dominantElement] || "") + "\n\n";
            }
            
            if (currentSpread === 'time') {
                reading += generateTimeReading(first, second, third, patterns);
            } else if (currentSpread === 'action') {
                reading += generateActionReading(first, second, third, patterns);
            } else {
                reading += generateBeingReading(first, second, third, patterns);
            }
            
            const synthesis = generateSynthesis(patterns, drawnCards);
            
            return { main: reading, synthesis: synthesis };
        }

        function analyzePatterns(cards) {
            const patterns = {
                majorCount: cards.filter(c => !c.type || c.type !== 'minor').length,
                reversedCount: cards.filter(c => c.isReversed).length,
                elements: {},
                transformation: false
            };
            
            cards.forEach(card => {
                const element = card.suitElement || card.element;
                patterns.elements[element] = (patterns.elements[element] || 0) + 1;
                
                if (card.number !== undefined) {
                    if ([13, 16, 20].includes(card.number)) patterns.transformation = true;
                }
            });
            
            let maxElement = null;
            let maxCount = 0;
            for (const [element, count] of Object.entries(patterns.elements)) {
                if (count > maxCount && count > 1) {
                    maxElement = element;
                    maxCount = count;
                }
            }
            patterns.dominantElement = maxElement;
            
            return patterns;
        }

        function generateTimeReading(past, present, future, patterns) {
            let reading = "";
            
            reading += `PAST: ${past.figure} as `;
            reading += past.type === 'minor' ? `${past.rank} of ${past.suit}` : past.arcana;
            reading += past.isReversed ? " reversed\n" : "\n";
            reading += `Foundation: ${past.isReversed ? past.meaning.reversed : past.meaning.upright}.\n`;
            reading += past.title + (past.isReversed ? " suggests unresolved patterns that still influence current decisions." : " established patterns that support current growth.");
            reading += "\n\n";
            
            reading += `PRESENT: ${present.figure} as `;
            reading += present.type === 'minor' ? `${present.rank} of ${present.suit}` : present.arcana;
            reading += present.isReversed ? " reversed\n" : "\n";
            reading += `Current state: ${present.isReversed ? present.meaning.reversed : present.meaning.upright}.\n`;
            reading += "This is your immediate work.\n\n";
            
            reading += `FUTURE: ${future.figure} as `;
            reading += future.type === 'minor' ? `${future.rank} of ${future.suit}` : future.arcana;
            reading += future.isReversed ? " reversed\n" : "\n";
            reading += `Emerging: ${future.isReversed ? future.meaning.reversed : future.meaning.upright}.\n`;
            reading += future.isReversed ? "This warns of potential challenges if current patterns continue unchanged." : "This promises positive outcomes from current efforts.";
            
            return reading;
        }

        function generateActionReading(situation, action, outcome, patterns) {
            let reading = "";
            
            reading += `SITUATION: ${situation.figure} as `;
            reading += situation.type === 'minor' ? `${situation.rank} of ${situation.suit}` : situation.arcana;
            reading += situation.isReversed ? " reversed\n" : "\n";
            reading += `Reality: ${situation.isReversed ? situation.meaning.reversed : situation.meaning.upright}.\n\n`;
            
            reading += `ACTION: ${action.figure} as `;
            reading += action.type === 'minor' ? `${action.rank} of ${action.suit}` : action.arcana;
            reading += action.isReversed ? " reversed\n" : "\n";
            reading += action.isReversed ? 
                `Avoid: ${action.meaning.reversed}. Work against these tendencies.\n\n` : 
                `Approach through: ${action.meaning.upright}. Lean into these qualities.\n\n`;
            
            reading += `OUTCOME: ${outcome.figure} as `;
            reading += outcome.type === 'minor' ? `${outcome.rank} of ${outcome.suit}` : outcome.arcana;
            reading += outcome.isReversed ? " reversed\n" : "\n";
            reading += `Result: ${outcome.isReversed ? outcome.meaning.reversed : outcome.meaning.upright}.`;
            
            return reading;
        }

        function generateBeingReading(mind, body, spirit, patterns) {
            let reading = "";
            
            reading += `MIND: ${mind.figure} as `;
            reading += mind.type === 'minor' ? `${mind.rank} of ${mind.suit}` : mind.arcana;
            reading += mind.isReversed ? " reversed\n" : "\n";
            reading += `Mental space: ${mind.isReversed ? mind.meaning.reversed : mind.meaning.upright}.\n\n`;
            
            reading += `BODY: ${body.figure} as `;
            reading += body.type === 'minor' ? `${body.rank} of ${body.suit}` : body.arcana;
            reading += body.isReversed ? " reversed\n" : "\n";
            reading += `Material reality: ${body.isReversed ? body.meaning.reversed : body.meaning.upright}.\n\n`;
            
            reading += `SPIRIT: ${spirit.figure} as `;
            reading += spirit.type === 'minor' ? `${spirit.rank} of ${spirit.suit}` : spirit.arcana;
            reading += spirit.isReversed ? " reversed\n" : "\n";
            reading += `Higher calling: ${spirit.isReversed ? spirit.meaning.reversed : spirit.meaning.upright}.`;
            
            return reading;
        }

        function generateSynthesis(patterns, cards) {
            let synthesis = "";
            
            if (patterns.transformation) {
                synthesis = "Death, Tower, or Judgement present — fundamental transformation is at hand. ";
            }
            
            if (patterns.reversedCount === 0) {
                synthesis += "All upright cards suggest clear energy flow and accessible resources. Move forward with confidence.";
            } else if (patterns.reversedCount === 1) {
                synthesis += "One reversal points to a specific blockage in an otherwise clear situation.";
            } else if (patterns.reversedCount === 2) {
                synthesis += "Multiple reversals suggest internal work takes precedence over external action.";
            }
            
            // Add numerological insight for Major Arcana
            const majors = cards.filter(c => c.number !== undefined);
            if (majors.length > 0) {
                const sum = majors.reduce((acc, card) => acc + card.number, 0);
                const reduced = sum % 22;
                synthesis += ` Numerologically, your Major Arcana reduce to ${reduced} (${majorArcana[reduced].figure}) — consider this hidden influence.`;
            }
            
            return synthesis;
        }

        function showInterpretation() {
            const interpretation = document.getElementById('interpretation');
            const cardMeanings = document.getElementById('cardMeanings');
            const spread = spreads[currentSpread];
            
            // Individual card meanings
            cardMeanings.innerHTML = drawnCards.map((card, index) => {
                const meaning = card.isReversed ? card.meaning.reversed : card.meaning.upright;
                const cardName = card.type === 'minor' ? 
                    `${card.rank} of ${card.suit}` : 
                    card.arcana;
                
                return `
                    <div class="card-meaning">
                        <h4>
                            ${spread.positions[index]}: ${cardName}
                            ${card.isReversed ? '<span class="reversed-badge">Reversed</span>' : ''}
                        </h4>
                        <p><strong>${card.figure}</strong> — <em>${card.title}</em></p>
                        <p style="margin-top: 0.5rem; font-size: 0.85rem; opacity: 0.8; font-style: italic;">${spread.descriptions[index]}</p>
                        <p style="margin-top: 0.5rem;">${meaning}</p>
                    </div>
                `;
            }).join('');
            
            // Generate synthesis
            const reading = generateReading();
            document.getElementById('synthesisText').innerHTML = reading.main.replace(/\n/g, '<br>');
            document.getElementById('guidance').innerHTML = reading.synthesis;
            
            interpretation.classList.add('show');
        }

        // Event listeners
        document.getElementById('drawButton').addEventListener('click', () => {
            initializeSpread();
            setTimeout(drawCards, 100);
        });
        
        document.querySelectorAll('.spread-option').forEach(option => {
            option.addEventListener('click', function() {
                if (isDrawing) return;
                
                document.querySelectorAll('.spread-option').forEach(o => o.classList.remove('active'));
                this.classList.add('active');
                currentSpread = this.dataset.spread;
                
                document.getElementById('interpretation').classList.remove('show');
                initializeSpread();
            });
        });

        // Initialize
        createStars();
        initializeSpread();
    </script>
</body>
</html>
